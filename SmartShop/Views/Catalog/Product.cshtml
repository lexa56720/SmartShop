@using SmartShop.DataBase.Tables
@model ProductViewModel;
@{
    ViewData["Title"] = Model.Smartphone.Name; // Set the title to the smartphone's name
    User? User = ViewBag.User;
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-6">
            <div id="mainImageCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    @foreach (var media in Model.Smartphone.Medias)
                    {
                        <div class="carousel-item
                         @if (media == Model.Smartphone.Medias[0])
                         {
                    <text>active</text>
}">
                                                    <img class="d-block w-100" style="max-height:500px; object-fit:scale-down; width: 100%" src="@media.Url" alt="@Model.Smartphone.Name">
                                        </div>
                    }
                </div>
                <a class="carousel-control-prev" href="#mainImageCarousel" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#mainImageCarousel" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
        <div class="col-md-6">
            <h2 class="mb-3">@Model.Smartphone.Name</h2>
            <p class="mb-4">@Model.Smartphone.Description</p>
            <ul class="list-unstyled">
                <li class="mb-2"><strong>Дата выхода:</strong> @Model.Smartphone.ReleaseDate.ToShortDateString()</li>
                <li class="mb-2"><strong>Производитель:</strong> @Model.Smartphone.Producer.Name</li>
                <li class="mb-2"><strong>Размер хранилищаe (GB):</strong> @Model.Smartphone.MemorySize</li>
                <li class="mb-2"><strong>Размер оперативной памяти (GB):</strong> @Model.Smartphone.RamSize</li>
                <li class="mb-2"><strong>Количество мегапикселей:</strong> @Model.Smartphone.MegaPixels</li>
                <li class="mb-2"><strong>Цена:</strong> $@Model.Smartphone.Price</li>
            </ul>

            @if (User == null || User.Role != Role.Admin)
                @if (Model.Smartphone.UnitsAvailable > 0)
                {
                    <button id="AddToCartButton @Model.Smartphone.Id" class="btn btn-primary" onclick="AddToCart(@Model.Smartphone.Id);">Добавить в корзину</button>
                }
                else
                {
                    <span class="text-danger">Нет в наличии</span>
                }
            @if (Model.Smartphone.Medias.Count > 1)
            {
                <div class="row mt-3">
                    @foreach (var media in Model.Smartphone.Medias)
                    {
                        <div class="col-md-4">
                            <img class="rounded" style="max-height:50px; max-width:50px" src="@media.Url"
                                 alt="@Model.Smartphone.Name" onclick="selectImage(@media.Url);">
                        </div>
                    }
                </div>
            }
        </div>
    </div>
</div>

<script>
    function selectImage(imageUrl) {
        $('#mainImageCarousel .carousel-inner').html(`<div class="carousel-item active"><img class="d-block w-100" src="${imageUrl}" alt="Selected Image"></div>`);
    }
</script>

<style>
    span.carousel-control-next-icon {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%23303030' width='8' height='8' viewBox='0 0 8 8'%3e%3cpath d='M2.75 0l-1.5 1.5L3.75 4l-2.5 2.5L2.75 8l4-4-4-4z'/%3e%3c/svg%3e");
    }

    span.carousel-control-prev-icon {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%23303030' width='8' height='8' viewBox='0 0 8 8'%3e%3cpath d='M5.25 0l-4 4 4 4 1.5-1.5L4.25 4l2.5-2.5L5.25 0z'/%3e%3c/svg%3e");
    }
</style>
